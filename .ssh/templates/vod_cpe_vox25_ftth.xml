<?xml version='1.0' encoding='UTF-8'?>
<template role="cpe" parent="role_cpe" version="2.0" type="role">

    <!-- ################################################################################ -->
    <!-- ##########################   PARAMETROS ######################################## -->
    <!-- ################################################################################ -->

    <parameters>
        <paremeter id="par_query_parameters_CPE_plume" type="value">
            <contents>
                <value type="value"><![CDATA["},{"query":  "$.extraId[schemeID='parameterNumber'].value=1"},
                    {"query":"$.characteristic[*].characteristicsValue[type = 'parameterName'].value=InternetGatewayDevice.Services.X_Plume.ControlMode"},
                    {"query":"$.resource[name='INPUT'].extraId[schemeName='ExecutionTimeoutSeconds'].value=60"},
                    {"query":"$.resource[name='INPUT'].extraId[schemeName='ExpirationTimeoutSeconds'].value=60"},
                    {"query":"$.resource[name='INPUT'].extraId[schemeName='Priority'].value=100"},
                    {"query":"$.resource[name='INPUT'].extraId[schemeName='updateCachedDataRecord'].value=false"},
                    {"query":"$.resource[name='INPUT'].extraId[schemeName='DisableCaptureConstraint'].value=true"},
                    {"query":"$.resource[name='INPUT'].extraId[schemeName='FailOnConnectionRequestFailure'].value=false"},
                    {"query":"$.resource[name='INPUT'].extraId[schemeName='RequestTimeout'].value=180000"}]}]]></value>
             </contents>
        </paremeter>
        <!--FCS20210624_REQ_005_1_3_Se añade query {"query":  "$.characteristic[*].characteristicsValue[type = 'parameterName'].value=InternetGatewayDevice.WANDevice.1.WANConnectionDevice.1.WANPPPConnection.1."}, numero de parametros antes 32-->
        <!-- FCS20210721_INC000042214120 _Antes: 33 numero de parametros -->
        <!-- JJSM 20220818 - SP1701 - Se añade InternetGatewayDevice.LANDevice.1.LANHostConfigManagement.X_EDNS0 -->
        <!-- JJSM 20220927 - SP1703 - Se añade InternetGatewayDevice.LANDevice.1.WLANConfiguration.1.X_AutoChannel.ChannelWhiteList -->
        <paremeter id="par_query_parameters_CPE" type="value">
            <contents>
                <value type="value"><![CDATA["},{"query":  "$.extraId[schemeID='parameterNumber'].value=52"},
                    {"query":"$.characteristic[*].characteristicsValue[type = 'parameterName'].value=InternetGatewayDevice.DeviceInfo.MemoryStatus.Free"},
                    {"query":"$.characteristic[*].characteristicsValue[type = 'parameterName'].value=InternetGatewayDevice.LANDevice.1.Hosts.HostNumberOfEntries"},
                    {"query":"$.characteristic[*].characteristicsValue[type = 'parameterName'].value=InternetGatewayDevice.LANDevice.1.WLANConfiguration.1.TotalAssociations"},
                    {"query":"$.characteristic[*].characteristicsValue[type = 'parameterName'].value=InternetGatewayDevice.LANDevice.1.WLANConfiguration.5.TotalAssociations"},
                    {"query":"$.characteristic[*].characteristicsValue[type = 'parameterName'].value=InternetGatewayDevice.Time.LocalTimeZone"},
                    {"query":"$.characteristic[*].characteristicsValue[type = 'parameterName'].value=InternetGatewayDevice.DeviceInfo.ProcessStatus.CPUUsage"},
                    {"query":"$.characteristic[*].characteristicsValue[type = 'parameterName'].value=InternetGatewayDevice.DeviceInfo.UpTime"},
                    {"query":"$.characteristic[*].characteristicsValue[type = 'parameterName'].value=InternetGatewayDevice.WANDevice.1.WANEthernetInterfaceConfig.MaxBitRate"},
                    {"query":"$.characteristic[*].characteristicsValue[type = 'parameterName'].value=InternetGatewayDevice.WANDevice.1.WANEthernetInterfaceConfig.DuplexMode"},
                    {"query":"$.characteristic[*].characteristicsValue[type = 'parameterName'].value=InternetGatewayDevice.WANDevice.1.WANEthernetInterfaceConfig.ShapingRate"},
                    {"query":"$.characteristic[*].characteristicsValue[type = 'parameterName'].value=InternetGatewayDevice.WANDevice.1.WANConnectionDevice.1.WANIPConnection.2.Enable"},
                    {"query":"$.characteristic[*].characteristicsValue[type = 'parameterName'].value=InternetGatewayDevice.WANDevice.1.WANConnectionDevice.1.WANIPConnection.2.ExternalIPAddress"},
                    {"query":  "$.characteristic[*].characteristicsValue[type = 'parameterName'].value=InternetGatewayDevice.WANDevice.1.WANConnectionDevice.1.WANPPPConnection.1."},

                    {"query":  "$.characteristic[*].characteristicsValue[type = 'parameterName'].value=InternetGatewayDevice.LANDevice.1.LANHostConfigManagement.X_EDNS0"},
					
                    {"query":  "$.characteristic[*].characteristicsValue[type = 'parameterName'].value=InternetGatewayDevice.LANDevice.1.WLANConfiguration.1.X_AutoChannel.ChannelWhiteList"},

                    {"query":  "$.characteristic[*].characteristicsValue[type = 'parameterName'].value=InternetGatewayDevice.LANDevice.1.WLANConfiguration.1.Status"},
                    {"query":  "$.characteristic[*].characteristicsValue[type = 'parameterName'].value=InternetGatewayDevice.LANDevice.1.WLANConfiguration.5.Status"},
                    {"query":  "$.characteristic[*].characteristicsValue[type = 'parameterName'].value=InternetGatewayDevice.LANDevice.1.WLANConfiguration.1.AutoChannelEnable"},
                    {"query":  "$.characteristic[*].characteristicsValue[type = 'parameterName'].value=InternetGatewayDevice.LANDevice.1.WLANConfiguration.5.AutoChannelEnable"},
                    {"query":  "$.characteristic[*].characteristicsValue[type = 'parameterName'].value=InternetGatewayDevice.LANDevice.1.WLANConfiguration.1.SSIDAdvertisementEnabled"},
                    {"query":  "$.characteristic[*].characteristicsValue[type = 'parameterName'].value=InternetGatewayDevice.LANDevice.1.WLANConfiguration.5.SSIDAdvertisementEnabled"},
                    {"query":  "$.characteristic[*].characteristicsValue[type = 'parameterName'].value=InternetGatewayDevice.LANDevice.1.WLANConfiguration.1.SSID"},
                    {"query":  "$.characteristic[*].characteristicsValue[type = 'parameterName'].value=InternetGatewayDevice.LANDevice.1.WLANConfiguration.5.SSID"},
                    {"query":"$.characteristic[*].characteristicsValue[type = 'parameterName'].value=InternetGatewayDevice.LANDevice.1.WLANConfiguration.5.AssociatedDevice."},
                    {"query":"$.characteristic[*].characteristicsValue[type = 'parameterName'].value=InternetGatewayDevice.LANDevice.1.WLANConfiguration.1.AssociatedDevice."},
                    {"query":"$.characteristic[*].characteristicsValue[type = 'parameterName'].value=InternetGatewayDevice.Services.X_BandSteering.Enable"},
                    {"query":"$.characteristic[*].characteristicsValue[type = 'parameterName'].value=InternetGatewayDevice.LANDevice.1.WLANConfiguration.1.Channel"},
                    {"query":  "$.characteristic[*].characteristicsValue[type = 'parameterName'].value=InternetGatewayDevice.LANDevice.1.WLANConfiguration.1.X_WlanAdapter.Band"},
                    {"query":"$.characteristic[*].characteristicsValue[type = 'parameterName'].value=InternetGatewayDevice.LANDevice.1.WLANConfiguration.1.RadioEnabled"},
                    {"query":"$.characteristic[*].characteristicsValue[type = 'parameterName'].value=InternetGatewayDevice.LANDevice.1.WLANConfiguration.5.Channel"},
                    {"query":  "$.characteristic[*].characteristicsValue[type = 'parameterName'].value=InternetGatewayDevice.LANDevice.1.WLANConfiguration.5.X_WlanAdapter.Band"},
                    {"query":"$.characteristic[*].characteristicsValue[type = 'parameterName'].value=InternetGatewayDevice.LANDevice.1.WLANConfiguration.5.RadioEnabled"},
                    {"query":"$.characteristic[*].characteristicsValue[type = 'parameterName'].value=InternetGatewayDevice.LANDevice.1.WLANConfiguration.1.BSSID"},
                    {"query":"$.characteristic[*].characteristicsValue[type = 'parameterName'].value=InternetGatewayDevice.LANDevice.1.WLANConfiguration.1.BeaconType"},
                    {"query":"$.characteristic[*].characteristicsValue[type = 'parameterName'].value=InternetGatewayDevice.LANDevice.1.WLANConfiguration.1.Enable"},
                    {"query":"$.characteristic[*].characteristicsValue[type = 'parameterName'].value=InternetGatewayDevice.LANDevice.1.WLANConfiguration.5.BSSID"},
                    {"query":"$.characteristic[*].characteristicsValue[type = 'parameterName'].value=InternetGatewayDevice.LANDevice.1.WLANConfiguration.5.BeaconType"},
                    {"query":"$.characteristic[*].characteristicsValue[type = 'parameterName'].value=InternetGatewayDevice.LANDevice.1.WLANConfiguration.5.Enable"},

                    {"query":"$.characteristic[*].characteristicsValue[type = 'parameterName'].value=InternetGatewayDevice.Services.VoiceService.1.PhyInterface.1.X_PortStatus"},
                    {"query":"$.characteristic[*].characteristicsValue[type = 'parameterName'].value=InternetGatewayDevice.Services.VoiceService.1.VoiceProfile.1.Line.1.SIP.AuthPassword"},
                    {"query":"$.characteristic[*].characteristicsValue[type = 'parameterName'].value=InternetGatewayDevice.Services.VoiceService.1.VoiceProfile.1.SIP.OutboundProxy"},
                    {"query":"$.characteristic[*].characteristicsValue[type = 'parameterName'].value=InternetGatewayDevice.Services.VoiceService.1.VoiceProfile.1.SIP.OutboundProxyPort"},
                    {"query":"$.characteristic[*].characteristicsValue[type = 'parameterName'].value=InternetGatewayDevice.Services.VoiceService.1.VoiceProfile.1.SIP.ProxyServer"},
                    {"query":"$.characteristic[*].characteristicsValue[type = 'parameterName'].value=InternetGatewayDevice.Services.VoiceService.1.VoiceProfile.1.SIP.ProxyServerPort"},
                    {"query":"$.characteristic[*].characteristicsValue[type = 'parameterName'].value=InternetGatewayDevice.Services.VoiceService.1.VoiceProfile.2.SIP.ProxyServer"},
                    {"query":"$.characteristic[*].characteristicsValue[type = 'parameterName'].value=InternetGatewayDevice.Services.VoiceService.1.VoiceProfile.2.SIP.ProxyServerPort"},
                    {"query":"$.characteristic[*].characteristicsValue[type = 'parameterName'].value=InternetGatewayDevice.Services.VoiceService.1.VoiceProfile.2.SIP.OutboundProxy"},
                    {"query":"$.characteristic[*].characteristicsValue[type = 'parameterName'].value=InternetGatewayDevice.Services.VoiceService.1.VoiceProfile.2.SIP.OutboundProxyPort"},
                    {"query":"$.characteristic[*].characteristicsValue[type = 'parameterName'].value=InternetGatewayDevice.Services.VoiceService.1.VoiceProfile.1.Line.1.DirectoryNumber"},
                    {"query":"$.characteristic[*].characteristicsValue[type = 'parameterName'].value=InternetGatewayDevice.Services.VoiceService.1.VoiceProfile.1.Line.1.SIP.AuthUserName"},
                    {"query":"$.characteristic[*].characteristicsValue[type = 'parameterName'].value=InternetGatewayDevice.Services.VoiceService.1.VoiceProfile.1.Line.1.Enable"},
                    {"query":"$.characteristic[*].characteristicsValue[type = 'parameterName'].value=InternetGatewayDevice.Services.VoiceService.1.VoiceProfile.1.Line.1.Status"},
                    {"query":"$.resource[name='INPUT'].extraId[schemeName='ExecutionTimeoutSeconds'].value=60"},
                    {"query":"$.resource[name='INPUT'].extraId[schemeName='ExpirationTimeoutSeconds'].value=60"},
                    {"query":"$.resource[name='INPUT'].extraId[schemeName='Priority'].value=100"},
                    {"query":"$.resource[name='INPUT'].extraId[schemeName='updateCachedDataRecord'].value=false"},
                    {"query":"$.resource[name='INPUT'].extraId[schemeName='DisableCaptureConstraint'].value=true"},
                    {"query":"$.resource[name='INPUT'].extraId[schemeName='FailOnConnectionRequestFailure'].value=false"},
                    {"query":"$.resource[name='INPUT'].extraId[schemeName='RequestTimeout'].value=180000"}]}]]></value>
     
            </contents>
        </paremeter>
        <paremeter id="par_query_wifi_base" type="value">
            <contents>
                <!--DBC_REQ_005_2_Se añaden parametros Bandwidth y BandSteering-->
                <value type="value"><![CDATA["},{"query":  "$.extraId[schemeID='parameterNumber'].value=24"},
                    {"query":"$.characteristic[*].characteristicsValue[type = 'parameterName'].value=InternetGatewayDevice.LANDevice.1.WLANConfiguration.1.X_WlanAdapter.BandWidth"},
                    {"query":"$.characteristic[*].characteristicsValue[type = 'parameterName'].value=InternetGatewayDevice.Services.X_BandSteering.Enable"},
                    {"query":"$.characteristic[*].characteristicsValue[type = 'parameterName'].value=InternetGatewayDevice.LANDevice.1.WLANConfiguration.1.SSID"},
                    {"query":"$.characteristic[*].characteristicsValue[type = 'parameterName'].value=InternetGatewayDevice.LANDevice.1.WLANConfiguration.1.Status"},
                    {"query":"$.characteristic[*].characteristicsValue[type = 'parameterName'].value=InternetGatewayDevice.LANDevice.1.WLANConfiguration.1.Channel"},
                    {"query":  "$.characteristic[*].characteristicsValue[type = 'parameterName'].value=InternetGatewayDevice.LANDevice.1.WLANConfiguration.1.X_WlanAdapter.Band"},
                    {"query":"$.characteristic[*].characteristicsValue[type = 'parameterName'].value=InternetGatewayDevice.LANDevice.1.WLANConfiguration.1.AutoChannelEnable"},
                    {"query":"$.characteristic[*].characteristicsValue[type = 'parameterName'].value=InternetGatewayDevice.LANDevice.1.WLANConfiguration.1.RadioEnabled"},
                    {"query":"$.characteristic[*].characteristicsValue[type = 'parameterName'].value=InternetGatewayDevice.LANDevice.1.WLANConfiguration.1.PreSharedKey.1.KeyPassphrase"},
                    {"query":"$.characteristic[*].characteristicsValue[type = 'parameterName'].value=InternetGatewayDevice.LANDevice.1.WLANConfiguration.5.SSID"},
                    {"query":"$.characteristic[*].characteristicsValue[type = 'parameterName'].value=InternetGatewayDevice.LANDevice.1.WLANConfiguration.5.Status"},
                    {"query":"$.characteristic[*].characteristicsValue[type = 'parameterName'].value=InternetGatewayDevice.LANDevice.1.WLANConfiguration.5.Channel"},
                    {"query":  "$.characteristic[*].characteristicsValue[type = 'parameterName'].value=InternetGatewayDevice.LANDevice.1.WLANConfiguration.5.X_WlanAdapter.Band"},
                    {"query":"$.characteristic[*].characteristicsValue[type = 'parameterName'].value=InternetGatewayDevice.LANDevice.1.WLANConfiguration.5.AutoChannelEnable"},
                    {"query":"$.characteristic[*].characteristicsValue[type = 'parameterName'].value=InternetGatewayDevice.LANDevice.1.WLANConfiguration.5.RadioEnabled"},
                    {"query":"$.characteristic[*].characteristicsValue[type = 'parameterName'].value=InternetGatewayDevice.LANDevice.1.WLANConfiguration.5.PreSharedKey.1.KeyPassphrase"},

                    {"query":"$.characteristic[*].characteristicsValue[type = 'parameterName'].value=InternetGatewayDevice.LANDevice.1.WLANConfiguration.1.BSSID"},
                    {"query":"$.characteristic[*].characteristicsValue[type = 'parameterName'].value=InternetGatewayDevice.LANDevice.1.WLANConfiguration.1.BeaconType"},
                    {"query":"$.characteristic[*].characteristicsValue[type = 'parameterName'].value=InternetGatewayDevice.LANDevice.1.WLANConfiguration.1.Enable"},
                    {"query":"$.characteristic[*].characteristicsValue[type = 'parameterName'].value=InternetGatewayDevice.LANDevice.1.WLANConfiguration.1.SSIDAdvertisementEnabled"},
                    {"query":"$.characteristic[*].characteristicsValue[type = 'parameterName'].value=InternetGatewayDevice.LANDevice.1.WLANConfiguration.5.BSSID"},
                    {"query":"$.characteristic[*].characteristicsValue[type = 'parameterName'].value=InternetGatewayDevice.LANDevice.1.WLANConfiguration.5.BeaconType"},
                    {"query":"$.characteristic[*].characteristicsValue[type = 'parameterName'].value=InternetGatewayDevice.LANDevice.1.WLANConfiguration.5.Enable"},
                    {"query":"$.characteristic[*].characteristicsValue[type = 'parameterName'].value=InternetGatewayDevice.LANDevice.1.WLANConfiguration.5.SSIDAdvertisementEnabled"},
                    {"query":"$.resource[name='INPUT'].extraId[schemeName='ExecutionTimeoutSeconds'].value=60"},
                    {"query":"$.resource[name='INPUT'].extraId[schemeName='ExpirationTimeoutSeconds'].value=60"},
                    {"query":"$.resource[name='INPUT'].extraId[schemeName='Priority'].value=100"},
                    {"query":"$.resource[name='INPUT'].extraId[schemeName='updateCachedDataRecord'].value=false"},
                    {"query":"$.resource[name='INPUT'].extraId[schemeName='DisableCaptureConstraint'].value=true"},
                    {"query":"$.resource[name='INPUT'].extraId[schemeName='FailOnConnectionRequestFailure'].value=false"},
                    {"query":"$.resource[name='INPUT'].extraId[schemeName='RequestTimeout'].value=180000"}]}]]></value>
            </contents>
        </paremeter>
        <paremeter id="par_query_con_devices" type="value">
            <contents>
                <value type="value"><![CDATA["},{"query":  "$.extraId[schemeID='parameterNumber'].value=5"},
                    {"query":"$.characteristic[*].characteristicsValue[type = 'parameterName'].value=InternetGatewayDevice.LANDevice.1.Hosts."},
                    {"query":  "$.characteristic[*].characteristicsValue[type = 'parameterName'].value=InternetGatewayDevice.LANDevice.1.WLANConfiguration.1.SSID"},
                    {"query":  "$.characteristic[*].characteristicsValue[type = 'parameterName'].value=InternetGatewayDevice.LANDevice.1.WLANConfiguration.5.SSID"},
                    {"query":"$.characteristic[*].characteristicsValue[type = 'parameterName'].value=InternetGatewayDevice.LANDevice.1.WLANConfiguration.5.AssociatedDevice."},
                    {"query":"$.characteristic[*].characteristicsValue[type = 'parameterName'].value=InternetGatewayDevice.LANDevice.1.WLANConfiguration.1.AssociatedDevice."},
                    {"query":"$.resource[name='INPUT'].extraId[schemeName='ExecutionTimeoutSeconds'].value=60"},
                    {"query":"$.resource[name='INPUT'].extraId[schemeName='ExpirationTimeoutSeconds'].value=60"},
                    {"query":"$.resource[name='INPUT'].extraId[schemeName='Priority'].value=100"},
                    {"query":"$.resource[name='INPUT'].extraId[schemeName='updateCachedDataRecord'].value=false"},
                    {"query":"$.resource[name='INPUT'].extraId[schemeName='DisableCaptureConstraint'].value=true"},
                    {"query":"$.resource[name='INPUT'].extraId[schemeName='FailOnConnectionRequestFailure'].value=false"},
                    {"query":"$.resource[name='INPUT'].extraId[schemeName='RequestTimeout'].value=180000"}]}]]></value>
            </contents>
        </paremeter>
        <!--<paremeter id="par_query_voice_parameters" type="value">
            <contents>
                <value type="value"><![CDATA["},{"query":  "$.extraId[schemeID='parameterNumber'].value=14"},
                    {"query":"$.characteristic[*].characteristicsValue[type = 'parameterName'].value=InternetGatewayDevice.Services.VoiceService.1.PhyInterface.1.X_PortStatus"},
                    {"query":"$.characteristic[*].characteristicsValue[type = 'parameterName'].value=InternetGatewayDevice.Services.VoiceService.1.VoiceProfile.1.Line.1.SIP.AuthPassword"},
                    {"query":"$.characteristic[*].characteristicsValue[type = 'parameterName'].value=InternetGatewayDevice.Services.VoiceService.1.VoiceProfile.1.SIP.OutboundProxy"},
                    {"query":"$.characteristic[*].characteristicsValue[type = 'parameterName'].value=InternetGatewayDevice.Services.VoiceService.1.VoiceProfile.1.SIP.OutboundProxyPort"},
                    {"query":"$.characteristic[*].characteristicsValue[type = 'parameterName'].value=InternetGatewayDevice.Services.VoiceService.1.VoiceProfile.1.SIP.ProxyServer"},
                    {"query":"$.characteristic[*].characteristicsValue[type = 'parameterName'].value=InternetGatewayDevice.Services.VoiceService.1.VoiceProfile.1.SIP.ProxyServerPort"},
                    {"query":"$.characteristic[*].characteristicsValue[type = 'parameterName'].value=InternetGatewayDevice.Services.VoiceService.1.VoiceProfile.2.SIP.ProxyServer"},
                    {"query":"$.characteristic[*].characteristicsValue[type = 'parameterName'].value=InternetGatewayDevice.Services.VoiceService.1.VoiceProfile.2.SIP.ProxyServerPort"},
                    {"query":"$.characteristic[*].characteristicsValue[type = 'parameterName'].value=InternetGatewayDevice.Services.VoiceService.1.VoiceProfile.2.SIP.OutboundProxy"},
                    {"query":"$.characteristic[*].characteristicsValue[type = 'parameterName'].value=InternetGatewayDevice.Services.VoiceService.1.VoiceProfile.2.SIP.OutboundProxyPort"},
                    {"query":"$.characteristic[*].characteristicsValue[type = 'parameterName'].value=InternetGatewayDevice.Services.VoiceService.1.VoiceProfile.1.Line.1.DirectoryNumber"},
                    {"query":"$.characteristic[*].characteristicsValue[type = 'parameterName'].value=InternetGatewayDevice.Services.VoiceService.1.VoiceProfile.1.Line.1.SIP.AuthUserName"},
                    {"query":"$.characteristic[*].characteristicsValue[type = 'parameterName'].value=InternetGatewayDevice.Services.VoiceService.1.VoiceProfile.1.Line.1.Enable"},
                    {"query":"$.characteristic[*].characteristicsValue[type = 'parameterName'].value=InternetGatewayDevice.Services.VoiceService.1.VoiceProfile.1.Line.1.Status"},
                    {"query":"$.resource[name='INPUT'].extraId[schemeName='ExecutionTimeoutSeconds'].value=60"},
                    {"query":"$.resource[name='INPUT'].extraId[schemeName='ExpirationTimeoutSeconds'].value=60"},
                    {"query":"$.resource[name='INPUT'].extraId[schemeName='Priority'].value=100"},
                    {"query":"$.resource[name='INPUT'].extraId[schemeName='updateCachedDataRecord'].value=false"},
                    {"query":"$.resource[name='INPUT'].extraId[schemeName='DisableCaptureConstraint'].value=true"},
                    {"query":"$.resource[name='INPUT'].extraId[schemeName='FailOnConnectionRequestFailure'].value=false"},
                    {"query":"$.resource[name='INPUT'].extraId[schemeName='RequestTimeout'].value=180000"}]}]]></value>
            </contents>
        </paremeter>-->
        <!-- PARÁMETROS DE LLAMADA PARA COMPROBAR POST LENTITUD -->
        <paremeter id="par_query_parameters_comprob_post_lentitud" type="value">
            <contents>
                <value type="value"><![CDATA["},{"query":  "$.extraId[schemeID='parameterNumber'].value=2"},{"query":  "$.characteristic[*].characteristicsValue[type = 'parameterName'].value=InternetGatewayDevice.WANDevice.1.WANEthernetInterfaceConfig.MaxBitRate"},{"query":  "$.characteristic[*].characteristicsValue[type = 'parameterName'].value=InternetGatewayDevice.WANDevice.1.WANEthernetInterfaceConfig.DuplexMode"},{"query":"$.resource[name='INPUT'].extraId[schemeName='ExecutionTimeoutSeconds'].value=60"},{"query":"$.resource[name='INPUT'].extraId[schemeName='ExpirationTimeoutSeconds'].value=60"},{"query":"$.resource[name='INPUT'].extraId[schemeName='Priority'].value=100"},{"query":"$.resource[name='INPUT'].extraId[schemeName='updateCachedDataRecord'].value=false"},{"query":"$.resource[name='INPUT'].extraId[schemeName='DisableCaptureConstraint'].value=true"},{"query":"$.resource[name='INPUT'].extraId[schemeName='FailOnConnectionRequestFailure'].value=false"},{"query":"$.resource[name='INPUT'].extraId[schemeName='RequestTimeout'].value=180000"}]}]]></value>
            </contents>
        </paremeter>
        <paremeter id="par_front_access_type" type="value">
            <contents>
                <value type="parameter" role="front">par_access_type</value>
            </contents>
        </paremeter>

        <parameter id="par_root_path_wifi" type="value">
            <contents>
                <value type="value">InternetGatewayDevice.LANDevice.1.WLANConfiguration.</value>
            </contents>
        </parameter>
	<!--DBC_Req_005_2_Inicio_Parametros para bandsteering-->
        <parameter id="par_root_path_bandsteering" type="value">
            <contents>
                <value type="value">InternetGatewayDevice.Services.X_BandSteering</value>
            </contents>
        </parameter>

        <parameter id="par_bandsteering_linkedssid" type="value">
          <contents>
            <value type="value">index,linkedssid;1,5;5,1</value>
          </contents>
          <sequence>
            <operation type="row_delimiter">
              <args><arg><value type="value">;</value></arg></args>
            </operation>
            <operation type="column_delimiter">
              <args><arg><value type="value">,</value></arg></args>
            </operation>
          </sequence>
        </parameter>

        <parameter id="par_root_path_bandwidth" type="value">
            <contents>
                <value type="value">InternetGatewayDevice.LANDevice.1.WLANConfiguration.1.X_WlanAdapter.BandWidth</value>
            </contents>
        </parameter>
	<!--DBC_Req_005_2_Fin_Parametros para bandsteering-->
        <parameter id="par_root_path_superwifi" type="value">
          <contents>
            <value type="value">InternetGatewayDevice.</value>
          </contents>
        </parameter>

        <!-- FCS20210705_REQ_005_1_3_INICIO -->
        <parameter id="par_path_wan_external_ip_address" type="value">
            <contents>
                <value type="value">InternetGatewayDevice.WANDevice.1.WANConnectionDevice.1.WANPPPConnection.1.ExternalIPAddress</value>
            </contents>
        </parameter>
        <!-- FCS20210705_REQ_005_1_3_FIN -->

        <parameter id="par_path_enable_ssid5" type="value">
            <contents>
                <value type="parameter">par_root_path_wifi</value>
                <value type="value">5.Enable</value>
            </contents>
        </parameter>
        <parameter id="par_path_radioenabled5" type="value">
            <contents>
                <value type="parameter">par_root_path_wifi</value>
                <value type="value">5.RadioEnabled</value>
            </contents>
        </parameter>
        <parameter id="par_path_ssid_oculto5" type="value">
            <contents>
                <value type="parameter">par_root_path_wifi</value>
                <value type="value">5.SSIDAdvertisementEnabled</value>
            </contents>
        </parameter>
        <parameter id="par_path_shapingrate" type="value">
            <contents>
                <value type="value">InternetGatewayDevice.WANDevice.1.WANEthernetInterfaceConfig.ShapingRate</value>
            </contents>
        </parameter>
        <parameter id="par_path_iftv" type="value">
            <contents>
                <value type="value">InternetGatewayDevice.WANDevice.1.WANConnectionDevice.1.WANIPConnection.2.Enable</value>
            </contents>
        </parameter>
        <parameter id="par_path_external_ip_address" type="value">
            <contents>
                <value type="value">InternetGatewayDevice.WANDevice.1.WANConnectionDevice.1.WANIPConnection.2.ExternalIPAddress</value>
            </contents>
        </parameter>

        <parameter id="par_cpcpe_iftv" type="value" name="CPE_IfTV">
            <contents>
                <value type="parameter">par_cpcpe_base_table</value>
            </contents>
            <sequence>
                <operation type="remove_pattern">
                    <args><arg><value type="value">characteristic.characteristicsValue.</value></arg></args>
                </operation>
                <operation type="header_selector">
                    <args><arg><value type="value">description;name;value</value></arg></args>
                </operation>
                <operation type="column_index">
                    <args><arg><value type="value">1</value></arg></args>
                </operation>
                <operation type="column_equal">
                    <args><arg><value type="value">value</value></arg></args>
                </operation>
                <operation type="column_index">
                    <args><arg><value type="value">2</value></arg></args>
                </operation>
                <operation type="replace_pattern">
                    <args><arg><value type="value">((.*WANIPConnection\.)([2])(\.Enable))@to@IfTV</value></arg></args>
                </operation>
                <operation type="column_contain">
                    <args><arg><value type="value">IfTV</value></arg></args>
                </operation>
                <operation type="column_selector">
                    <args><arg><value type="value">3</value></arg></args>
                </operation>
            </sequence>
        </parameter>

        <parameter id="par_cpcpe_external_ip_address" type="value">
            <contents>
                <value type="parameter">par_cpcpe_base_table</value>
            </contents>
            <sequence>
                <operation type="remove_pattern">
                    <args><arg><value type="value">characteristic.characteristicsValue.</value></arg></args>
                </operation>
                <operation type="header_selector">
                    <args><arg><value type="value">description;name;value</value></arg></args>
                </operation>
                <operation type="column_index">
                    <args><arg><value type="value">1</value></arg></args>
                </operation>
                <operation type="column_equal">
                    <args><arg><value type="value">value</value></arg></args>
                </operation>
                <operation type="column_index">
                    <args><arg><value type="value">2</value></arg></args>
                </operation>
                <operation type="column_equal">
                    <args><arg><value type="parameter">par_path_external_ip_address</value></arg></args>
                </operation>
                <operation type="column_selector">
                    <args><arg><value type="value">3</value></arg></args>
                </operation>
            </sequence>
        </parameter>

        <parameter id="par_wifi_ssids" type="table" name="Resumen SSIDs">
            <contents>
                <value type="parameter">par_cpcpe_wifi_base_table</value>
            </contents>
            <sequence>
                <operation type="header_selector">
                    <args><arg><value type="value">key;key;value</value></arg></args>
                </operation>
                <operation type="first_row">
                    <args><arg><value type="value">2</value></arg></args>
                </operation>
                <!-- Nos quedamos con los valores que empiecen por esa raíz -->
                <operation type="column_index">
                    <args><arg><value type="value">2</value></arg></args>
                </operation>
                <operation type="column_contain">
                    <args><arg><value type="value">InternetGatewayDevice.LANDevice.1.WLANConfiguration.</value></arg></args>
                </operation>
                <operation type="column_index">
                    <args><arg><value type="value">2</value></arg></args>
                </operation>
                <operation type="replace_pattern">
                    <args><arg><value type="value">InternetGatewayDevice.LANDevice.1.WLANConfiguration.([0-9]+)\..*@to@$1</value></arg></args>
                </operation>
                <!-- Eliminamos la raíz de las claves para quedarnos con el nombre "local" -->
                <operation type="column_index">
                    <args><arg><value type="value">1</value></arg></args>
                </operation>
                <operation type="replace_pattern">
                    <args><arg><value type="value">InternetGatewayDevice.LANDevice.1.WLANConfiguration.[0-9]+\.(.*)@to@$1</value></arg></args>
                </operation>
                <!-- Le añadimos el índice a los valores para poder ordenar -->
                <operation type="add_header">
                    <args><arg><value type="value">key;index;value</value></arg></args>
                </operation>
                <operation type="column_left">
                    <args><arg><value type="value">index</value></arg></args>
                </operation>
                <operation type="column_right">
                    <args><arg><value type="value">value</value></arg></args>
                </operation>
                <operation type="merge">
                    <args><arg><value type="value">_</value></arg></args>
                </operation>
                <!-- Ordenamos por la nueva columna para tener las claves ordenadas por orden -->
                <operation type="first_row">
                    <args><arg><value type="value">2</value></arg></args>
                </operation>
                <operation type="column_index">
                    <args><arg><value type="value">2</value></arg></args>
                </operation>
                <operation type="order_lex">
                    <args><arg><value type="value">asc</value></arg></args>
                </operation>
                <!-- Convertimos la tabla clave valor en una tabla por ssid-->
                <operation type="transpose"/>
                <operation type="compact_table"/>

                <!-- Seleccionamos las cabeceras necesarias para la tabla final duplicando una de ellas como la primera para extraer el indice metido en el paso previo del merge -->
                <operation type="header_selector">
                    <args><arg><value type="value">BSSID;Status;SSID;BSSID;X_WlanAdapter.Band;Channel;AutoChannelEnable;BeaconType</value></arg></args>
                </operation>
                <operation type="ignore_header">
                    <args><arg><value type="value">true</value></arg></args>
                </operation>

                <!-- Eliminamos la cabecera y extraemos el indice de la columan duplicada -->
                <operation type="column_index">
                    <args><arg><value type="value">1</value></arg></args>
                </operation>
                <operation type="replace_pattern">
                    <args><arg><value type="value">([0-9])_.*@to@$1</value></arg></args>
                </operation>

                <!-- Eliminamos el valor del indice del resto de campos -->
                <operation type="column_index">
                    <args><arg><value type="value">0</value></arg></args>
                </operation>
                <operation type="replace_pattern">
                    <args><arg><value type="value">[0-9]_(.*)@to@$1</value></arg></args>
                </operation>
                <!-- BAND: b24, b5 -->
                <!-- Obtenemos la banda de los posibles canales en vez del canal actual, porque cuando el ssid está apagado y el autochannel está encendido, el canal se pone en 0 -->
                <operation type="column_index">
                    <args><arg><value type="value">5</value></arg></args>
                </operation>
                <operation type="replace_pattern">
                    <args><arg><value type="value">^(2.*)$@to@b24</value></arg></args>
                </operation>
                <operation type="replace_pattern">
                    <args><arg><value type="value">^(5.*)$@to@b5</value></arg></args>
                </operation>

                <!-- SECTYPE: open, wep64, wep128, wpapsk, wpa2psk, wpa12psk -->
                <operation type="column_index">
                    <args><arg><value type="value">8</value></arg></args>
                </operation>
                <operation type="replace_pattern">
                    <args><arg><value type="value">^None$@to@open</value></arg></args>
                </operation>
                <operation type="replace_pattern">
                    <args><arg><value type="value">^Basic$@to@wep64</value></arg></args>
                </operation>
                <operation type="replace_pattern">
                    <args><arg><value type="value">^WPA$@to@wpapsk</value></arg></args>
                </operation>
                <operation type="replace_pattern">
                    <args><arg><value type="value">^11i$@to@wpa2psk</value></arg></args>
                </operation>
                <operation type="replace_pattern">
                    <args><arg><value type="value">^WPAand11i$@to@wpa12psk</value></arg></args>
                </operation>

                <!-- ENABLED: true, false-->
                <operation type="column_index">
                    <args><arg><value type="value">2</value></arg></args>
                </operation>
                <operation type="replace_pattern">
                    <args><arg><value type="value">^(Up)$@to@true</value></arg></args>
                </operation>
                <operation type="replace_pattern">
                    <args><arg><value type="value">^(Error|Disabled)$@to@false</value></arg></args>
                </operation>

                <!-- AutoChannel: true, false -->
                <operation type="column_index">
                    <args><arg><value type="value">7</value></arg></args>
                </operation>
                <operation type="replace_pattern">
                    <args><arg><value type="value">^1$@to@true</value></arg></args>
                </operation>
                <operation type="replace_pattern">
                    <args><arg><value type="value">^0$@to@false</value></arg></args>
                </operation>
                <!-- Dejamos las cabeceras finales -->
                <operation type="first_row">
                    <args><arg><value type="value">2</value></arg></args>
                </operation>
                <operation type="add_header">
                    <args><arg><value type="value">index;enabled;ssid;bssid;band;channel;autochannel;sectype</value></arg></args>
                </operation>
		<!--DBC_Req_005_2_Inicio-->
                <operation type="column_left">
                      <args><arg><value type="value">index</value></arg></args>
                </operation>
                <operation type="column_right">
                  <args><arg><value type="value">index</value></arg></args>
                </operation>
                <operation type="join">
                  <args><arg><value type="parameter">par_bandsteering_linkedssid</value></arg></args>
                </operation>
		<!--DBC_Req_005_2_Fin-->
            </sequence>
        </parameter>

        <!-- FCS20210721_INC000042214120  -->
        <parameter id="par_wifi_ssids_diag" type="table" name="Resumen SSIDs">
            <contents>
                <value type="parameter">par_cpcpe_base_table</value>
            </contents>
            <sequence>
                <operation type="remove_pattern">
                    <args><arg><value type="value">characteristic.characteristicsValue.</value></arg></args>
                </operation>
                <operation type="header_selector">
                    <args><arg><value type="value">description;name;value</value></arg></args>
                </operation>
                <operation type="column_index">
                    <args><arg><value type="value">2</value></arg></args>
                </operation>
                <operation type="column_contain">
                    <args><arg><value type="value">WLANConfiguration</value></arg></args>
                </operation>
                <operation type="column_index">
                 <args><arg><value type="value">1</value></arg></args>
                </operation>
                <operation type="column_contain">
                    <args><arg><value type="value">value</value></arg></args>
                </operation>
                <operation type="column_index">
                    <args><arg><value type="value">2</value></arg></args>
                </operation>
                <operation type="order_lex">
                    <args><arg><value type="value">asc</value></arg></args>
                </operation>
                <operation type="add_header">
                    <args><arg><value type="value">#;key;value</value></arg></args>
                </operation>
                <operation type="header_selector">
                    <args><arg><value type="value">key;value</value></arg></args>
                </operation>
                <operation type="header_selector">
                    <args><arg><value type="value">key;key;value</value></arg></args>
                </operation>
                <operation type="first_row">
                    <args><arg><value type="value">2</value></arg></args>
                </operation>
                <!-- Nos quedamos con los valores que empiecen por esa raíz -->
                <operation type="column_index">
                    <args><arg><value type="value">2</value></arg></args>
                </operation>
                <operation type="column_contain">
                    <args><arg><value type="value">InternetGatewayDevice.LANDevice.1.WLANConfiguration.</value></arg></args>
                </operation>
                <operation type="column_index">
                    <args><arg><value type="value">2</value></arg></args>
                </operation>
                <operation type="replace_pattern">
                    <args><arg><value type="value">InternetGatewayDevice.LANDevice.1.WLANConfiguration.([0-9]+)\..*@to@$1</value></arg></args>
                </operation>
                <!-- Eliminamos la raíz de las claves para quedarnos con el nombre "local" -->
                <operation type="column_index">
                    <args><arg><value type="value">1</value></arg></args>
                </operation>
                <operation type="replace_pattern">
                    <args><arg><value type="value">InternetGatewayDevice.LANDevice.1.WLANConfiguration.[0-9]+\.(.*)@to@$1</value></arg></args>
                </operation>
                <!-- Le añadimos el índice a los valores para poder ordenar -->
                <operation type="add_header">
                    <args><arg><value type="value">key;index;value</value></arg></args>
                </operation>
                <operation type="column_left">
                    <args><arg><value type="value">index</value></arg></args>
                </operation>
                <operation type="column_right">
                    <args><arg><value type="value">value</value></arg></args>
                </operation>
                <operation type="merge">
                    <args><arg><value type="value">_</value></arg></args>
                </operation>
                <!-- Ordenamos por la nueva columna para tener las claves ordenadas por orden -->
                <operation type="first_row">
                    <args><arg><value type="value">2</value></arg></args>
                </operation>
                <operation type="column_index">
                    <args><arg><value type="value">2</value></arg></args>
                </operation>
                <operation type="order_lex">
                    <args><arg><value type="value">asc</value></arg></args>
                </operation>
                <!-- Convertimos la tabla clave valor en una tabla por ssid-->
                <operation type="transpose"/>
                <operation type="compact_table"/>

                <!-- Seleccionamos las cabeceras necesarias para la tabla final duplicando una de ellas como la primera para extraer el indice metido en el paso previo del merge -->
                <operation type="header_selector">
                    <args><arg><value type="value">BSSID;Status;SSID;BSSID;X_WlanAdapter.Band;Channel;AutoChannelEnable;BeaconType</value></arg></args>
                </operation>
                <operation type="ignore_header">
                    <args><arg><value type="value">true</value></arg></args>
                </operation>

                <!-- Eliminamos la cabecera y extraemos el indice de la columan duplicada -->
                <operation type="column_index">
                    <args><arg><value type="value">1</value></arg></args>
                </operation>
                <operation type="replace_pattern">
                    <args><arg><value type="value">([0-9])_.*@to@$1</value></arg></args>
                </operation>

                <!-- Eliminamos el valor del indice del resto de campos -->
                <operation type="column_index">
                    <args><arg><value type="value">0</value></arg></args>
                </operation>
                <operation type="replace_pattern">
                    <args><arg><value type="value">[0-9]_(.*)@to@$1</value></arg></args>
                </operation>
                <!-- BAND: b24, b5 -->
                <!-- Obtenemos la banda de los posibles canales en vez del canal actual, porque cuando el ssid está apagado y el autochannel está encendido, el canal se pone en 0 -->
                <operation type="column_index">
                    <args><arg><value type="value">5</value></arg></args>
                </operation>
                <operation type="replace_pattern">
                    <args><arg><value type="value">^(2.*)$@to@b24</value></arg></args>
                </operation>
                <operation type="replace_pattern">
                    <args><arg><value type="value">^(5.*)$@to@b5</value></arg></args>
                </operation>

                <!-- SECTYPE: open, wep64, wep128, wpapsk, wpa2psk, wpa12psk -->
                <operation type="column_index">
                    <args><arg><value type="value">8</value></arg></args>
                </operation>
                <operation type="replace_pattern">
                    <args><arg><value type="value">^None$@to@open</value></arg></args>
                </operation>
                <operation type="replace_pattern">
                    <args><arg><value type="value">^Basic$@to@wep64</value></arg></args>
                </operation>
                <operation type="replace_pattern">
                    <args><arg><value type="value">^WPA$@to@wpapsk</value></arg></args>
                </operation>
                <operation type="replace_pattern">
                    <args><arg><value type="value">^11i$@to@wpa2psk</value></arg></args>
                </operation>
                <operation type="replace_pattern">
                    <args><arg><value type="value">^WPAand11i$@to@wpa12psk</value></arg></args>
                </operation>

                <!-- ENABLED: true, false-->
                <operation type="column_index">
                    <args><arg><value type="value">2</value></arg></args>
                </operation>
                <operation type="replace_pattern">
                    <args><arg><value type="value">^(Up)$@to@true</value></arg></args>
                </operation>
                <operation type="replace_pattern">
                    <args><arg><value type="value">^(Error|Disabled)$@to@false</value></arg></args>
                </operation>

                <!-- AutoChannel: true, false -->
                <operation type="column_index">
                    <args><arg><value type="value">7</value></arg></args>
                </operation>
                <operation type="replace_pattern">
                    <args><arg><value type="value">^1$@to@true</value></arg></args>
                </operation>
                <operation type="replace_pattern">
                    <args><arg><value type="value">^0$@to@false</value></arg></args>
                </operation>
                <!-- Dejamos las cabeceras finales -->
                <operation type="first_row">
                    <args><arg><value type="value">2</value></arg></args>
                </operation>
                <operation type="add_header">
                    <args><arg><value type="value">index;enabled;ssid;bssid;band;channel;autochannel;sectype</value></arg></args>
                </operation>
		<!--DBC_Req_005_2_Inicio-->
                <operation type="column_left">
                      <args><arg><value type="value">index</value></arg></args>
                </operation>
                <operation type="column_right">
                  <args><arg><value type="value">index</value></arg></args>
                </operation>
                <operation type="join">
                  <args><arg><value type="parameter">par_bandsteering_linkedssid</value></arg></args>
                </operation>
		<!--DBC_Req_005_2_Fin-->
            </sequence>
        </parameter>

        <!-- Para no reescribir todos los diagnósticos de Voz para este CPE y ahorrar tiempo de ejecución, se comprobará que se realice bien la llamada general en vez de la individual de Voz, pero conservará el nombre de "voice"-->
          <parameter id="par_cpcpe_voice_http_code" type="value">
              <contents>
                <value type="infosource_value" infosource="cpe" endpointid="Consulta_parametros_CPE">_httpCode</value>
              </contents> 
          </parameter>

          <parameter id="par_cpcpe_voice_err_code">
              <contents>
                <value type="infosource_value" infosource="cpe" endpointid="Consulta_parametros_CPE">_errCode</value>
              </contents>
          </parameter>

          <parameter id="par_cpcpe_voice_err_desc">
              <contents>
                <value type="infosource_value" infosource="cpe" endpointid="Consulta_parametros_CPE">_errDesc</value>
              </contents>
          </parameter>
          <!--CCA 20211102 Check para comprobar que tiene serviceID - INICIO-->
            <parameter id="par_grc_service_id_front" type="value">
                <contents>
                    <value type="parameter" role="front">par_grc_service_id</value>
                </contents>
            </parameter>
           <!--CCA 20211102 Check para comprobar que tiene serviceID - FIN-->
    </parameters>
    <tests>
        <test id="tst_template">
            <expr type="and">
                <!--CCA 20211102 Check para comprobar que tiene serviceID - INICIO-->
                <reference type="check" id="chk_template_technology"/>
                <reference type="check" id="chk_grc_service_id_eq_unknown" inverse="true"/>
                <reference type="check" id="chk_grc_service_type_eq_mobile" inverse="true"/><!--TML20220617 - limitación a clientes no mobiles-->
                <reference type="check" id="chk_template"/>
                <!--CCA 20211102 Check para comprobar que tiene serviceID - FIN-->
            </expr>
        </test>
    </tests>
    <checks>
        <check id="chk_template">
            <parameter>par_od_resource_productclass</parameter>
            <result>
                <expr type="and">
                    <operation type="contains">
                        <args><arg><value type="value">VOX25</value></arg></args>
                    </operation>
                </expr>
            </result>
        </check>
        <!--Aquí habrá que hacer un check para comprobar que sea esta tecnología-->
        <check id="chk_template_technology">
             <parameter>par_front_access_type</parameter>
             <result>
                 <expr type="and">
                     <operation type="equal">
                         <args><arg><value type="value">FTTH</value></arg></args>
                     </operation>
                 </expr>
             </result>
         </check>
         <!--CCA 20211102 Check para comprobar que tiene serviceID - INICIO-->
        <check id="chk_grc_service_id_eq_unknown">
            <parameter>par_grc_service_id_front</parameter>
            <result>
                <expr type="and">
                    <operation type="equal">
                        <args><arg><value type="value">unknown</value></arg></args>
                    </operation>
                </expr>
            </result>
        </check>
        <!--CCA 20211102 Check para comprobar que tiene serviceID - FIN-->
    </checks>

    <actions>
        <action id="act_wifi_ssid_setsecurity" type="config">
            <texts>
                <text type="detail">Configurar seguridad de tu red WiFi</text>
                <text type="help">Pulsa sobre esta opción si quieres cambiar la seguridad de tu entorno WIFI</text>
                <!--<text type="warning">Vas a configurar la seguridad de tu red WiFi, los dispositivos actualmente conectados perderán la conexión a tu red WiFi y tendrás que reconfigurarlos de forma manual para que la recuperen</text>-->
                <text type="ok">La seguridad de tu red WiFi ha sido modificada</text>
                <text type="error">Ha habido un problema para aplicar los cambios, por favor inténtalo de nuevo pasados unos minutos</text>
            </texts>
            <inputs>
                <input id="sectype" type="list" >
                    <text><value>Seguridad</value></text>
                    <default>
                        <value>wpa2psk</value>
                    </default>
                    <valuelist>
                        <value label="WPA PSK">wpapsk</value>
                        <value label="WPA2 PSK">wpa2psk</value>
                    </valuelist>
                </input>
                <input id="password" type="text" valuetype="ascii">
                    <minlengths>
                        <minlength type="input" id="sectype" equal="open">
                            <value type="value">0</value>
                        </minlength>
                        <minlength type="input" id="sectype" equal="wpapsk">
                            <value type="configuration">cfg_wifi_wpapsk_pwd_minlength</value>
                        </minlength>
                        <minlength type="input" id="sectype" equal="wpa2psk">
                            <value type="configuration">cfg_wifi_wpa2psk_pwd_minlength</value>
                        </minlength>
                    </minlengths>
                    <maxlengths>
                        <maxlength type="input" id="sectype" equal="open">
                            <value type="value">0</value>
                        </maxlength>
                        <maxlength type="input" id="sectype" equal="wpapsk">
                            <value type="configuration">cfg_wifi_wpapsk_pwd_maxlength</value>
                        </maxlength>
                        <maxlength type="input" id="sectype" equal="wpa2psk">
                            <value type="configuration">cfg_wifi_wpa2psk_pwd_maxlength</value>
                        </maxlength>
                        <maxlength type="input" id="sectype" equal="wpa12psk">
                            <value type="configuration">cfg_wifi_wpa12psk_pwd_maxlength</value>
                        </maxlength>
                    </maxlengths>
                    <text><value type="value">Contraseña</value></text>
                </input>
            </inputs>
            <sequence>
                <!-- wpapsk -->
                <step type="infosource" infosource="cpe" endpointid="act_setsecurity">
                    <requirement>
                        <expr type="or">
                            <reference type="input" id="sectype" equal="wpapsk"/>
                        </expr>
                    </requirement>
                    <args>
                        <arg argid="number_of_params">
                            <value type="value">3</value>
                        </arg>
                        <arg loopid="params" index="0" argid="key">
                            <value type="value">InternetGatewayDevice.LANDevice.1.WLANConfiguration.</value>
                            <value type="argument">index</value>
                            <value type="value">.BeaconType</value>
                        </arg>
                        <arg loopid="params" index="0" argid="value">
                            <value type="value">WPA</value>
                        </arg>
                        <arg loopid="params" index="1" argid="key">
                            <value type="value">InternetGatewayDevice.LANDevice.1.WLANConfiguration.</value>
                            <value type="argument">index</value>
                            <value type="value">.WPAEncryptionModes</value>
                        </arg>
                        <arg loopid="params" index="1" argid="value">
                            <value type="value">AESEncryption</value>
                        </arg>
                        <arg loopid="params" index="2" argid="key">
                            <value type="value">InternetGatewayDevice.LANDevice.1.WLANConfiguration.</value>
                            <value type="argument">index</value>
                            <value type="value">.PreSharedKey.1.KeyPassphrase</value>
                        </arg>
                        <arg loopid="params" index="2" argid="value">
                            <value type="input">password</value>
                        </arg>
                    </args>
                </step>
                <!-- wpa2psk -->
                <step type="infosource" infosource="cpe" endpointid="act_setsecurity">
                    <requirement>
                        <expr type="or">
                            <reference type="input" id="sectype" equal="wpa2psk"/>
                        </expr>
                    </requirement>
                    <args>
                        <arg argid="number_of_params">
                            <value type="value">4</value>
                        </arg>
                        <arg loopid="params" index="0" argid="key">
                            <value type="value">InternetGatewayDevice.LANDevice.1.WLANConfiguration.</value>
                            <value type="argument">index</value>
                            <value type="value">.BeaconType</value>
                        </arg>
                        <arg loopid="params" index="0" argid="value">
                            <value type="value">11i</value>
                        </arg>
                        <arg loopid="params" index="1" argid="key">
                            <value type="value">InternetGatewayDevice.LANDevice.1.WLANConfiguration.</value>
                            <value type="argument">index</value>
                            <value type="value">.WPAEncryptionModes</value>
                        </arg>
                        <arg loopid="params" index="1" argid="value">
                            <value type="value">AESEncryption</value>
                        </arg>

                        <arg loopid="params" index="2" argid="key">
                            <value type="value">InternetGatewayDevice.LANDevice.1.WLANConfiguration.</value>
                            <value type="argument">index</value>
                            <value type="value">.IEEE11iEncryptionModes</value>
                        </arg>
                        <arg loopid="params" index="2" argid="value">
                            <value type="value">AESEncryption</value>
                        </arg>
                        <arg loopid="params" index="3" argid="key">
                            <value type="value">InternetGatewayDevice.LANDevice.1.WLANConfiguration.</value>
                            <value type="argument">index</value>
                            <value type="value">.PreSharedKey.1.KeyPassphrase</value>
                        </arg>
                        <arg loopid="params" index="3" argid="value">
                            <value type="input">password</value>
                        </arg>
                    </args>
                </step>
            </sequence>
            <messages>
              <message id="msg_act_setsecurity_ok" severity="info" datatype="text" storable="true">
                <body><value type="value">Se ha modificado la seguridad de la red wifi</value></body>
                <requirement>
                  <expr type="and">      
                    <reference type="test" id="tst_cpeapi_setsecurity_httpcode_isok"/>
                  </expr>
                </requirement>
              </message>
              <message id="msg_act_setsecurity_ko" severity="error" datatype="text" storable="true">
                <body><value type="value">No se pudo modificar la seguridad de la red wifi</value></body>
                <requirement>
                  <expr type="and">
                    <reference type="test" id="tst_cpeapi_setsecurity_httpcode_isok" inverse="true"/>
                  </expr>
                </requirement>
              </message>
            </messages>
            <result>
              <expr type="and">
                <reference type="test" id="tst_cpeapi_setsecurity_httpcode_isok"/>
              </expr>
            </result>
        </action>
    </actions>
</template>